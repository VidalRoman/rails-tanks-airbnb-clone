<p><%= @user.email  %></p>

<h3>Your Total earnings (past & present) are: <%= @earnings  %>€</h3>


<div class="container-fluid", style="display: flex">
  <div class="container">
    <h2>Your <%= link_to "Tanks", your_tanks_path() %></h2>
    <% @tanks.each do |tank| %>
      <div class="tank-card">
        <%= link_to tank.name, tank_path(tank) %>
        <%= tank.description  %>
        <br>
        
        <%= tank.price_per_day %> | <%= tank.capacity %>
      </div>
    <% end %>
  </div>

  <div class="container">
    <h2>My Bookings</h2>
    <% @bookings.each do |booking| %>
      <div class="card mb-3" style="max-width: 780px;">
        <div class="row bg-light">
          <div class="col-lg-6 col-xl-6 pl-0">
            <% if booking.tank.photos.present? %>
              <%= cl_image_tag booking.tank.photos.first.key, height: 300, width: 300, crop: :fill%>
            <% else %>
              <%= cl_image_tag 'tank1_xkesh5', height: 300, width: 300, crop: :fill %>
            <% end %>
          </div>
          <div class="col-lg-7 col-xl-6">
            <div class="card-body">
              <h3 class="card-title">
                From <%= booking.from_date  %> to <%= booking.to_date %>
              </h3>
                <% total_days = (booking.to_date - booking.from_date) %>
                <p class="card-text">
                  Total Days: <%= total_days.to_i %>
                </p>
                <p class="card-text">
                  Tank: <%= link_to booking.tank.name, tank_path(booking.tank) %>
                </p>
                <p class="card-text">
                  Total Price: <%= (booking.tank.price_per_day * total_days).to_i  %> €
                </p>
                <h3>
                  <%= booking.booking_status %>
                </h3>
                <% if booking.booking_status == "Canceled" %>
                  <%= link_to 'Delete Booking', booking_path(booking, booking_status: "Canceled"), class: "btn btn-outline-danger",
                    method: :delete,
                    data: { confirm: "Are you sure"} %>
                <% else %>
                <%= link_to 'Cancel', booking_path(booking, booking_status: "Canceled"), class: "btn btn-danger",
                  method: :patch,
                  data: { confirm: "Are you sure"} %>
                <% end %>
            </div>
          </div>
        </div>
      </div>
   <% end %>
  </div>

</div>

<h2>My tanks and their upcoming bookings (by other people)</h2>

<% @tanks.each do |tank| %>
  <div class="container">
  <h3><%= tank.name  %></h3>
  <% tank.bookings.each do |booking| %>
    <div class="booking-card container">
     <p>Who wants to rent: <%= booking.user.email %></p>
     <% total_days = (booking.to_date - booking.from_date) %>
     <p>For <%= total_days.to_i %> Days and <%= (booking.tank.price_per_day * total_days).to_i %> €</p>
     <p>Between <%= booking.from_date  %> and <%= booking.to_date  %></p>
     <p><%= booking.booking_status  %></p>
     <% if booking.booking_status == "in Review" %>
        <%= link_to 'Accept', booking_path(booking, booking_status: "Accepted"), class: "btn btn-success",
        method: :patch,
        data: { confirm: "Are you sure"} %>
        <%= link_to 'Decline', booking_path(booking, booking_status: "Declined"), class: "btn btn-danger",
        method: :patch,
        data: { confirm: "Are you sure"} %>
      <% elsif booking.booking_status == "Accepted" %>
        <%= link_to 'Cancel', booking_path(booking, booking_status: "Canceled"), class: "btn btn-danger",
        method: :patch,
        data: { confirm: "Are you sure"} %>
      <% else %>
        <%= link_to 'Delete Booking', booking_path(booking, booking_status: "Canceled"), class: "btn btn-outline-danger",
        method: :delete,
        data: { confirm: "Are you sure"} %>
      <% end %>
    </div>
  <% end %>
  </div>


<% end %>
